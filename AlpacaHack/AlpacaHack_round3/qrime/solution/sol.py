from Crypto.Util.number import  long_to_bytes
from sympy import nextprime, integer_nthroot


n=1597349797582252189737622221791988995702203505409122048213056145385432056678668011744383472026126622313229593211723275251532300454579372254725326775404977015496304747248416324105306138292084116374337609917577700786808299040936359837
e=65537
c=972720840499592344446463443980685660383495734796643528156038336075094110601869565083456517200700906514513655122880885701228182964785192363570987340004695486727354284548049636771649892722940274205296325372249242376864953467610809561
r=93306715077150526900611207656501624167797808502485855834333355823957291927822
q=0

r_next = nextprime(r)
print(r_next)
for i in range(10000):
    a = r_next + r
    b = i * r
    D = b*b + 4*a*n
    s, exact = integer_nthroot(D, 2)
    if not exact:
        continue

    denom = 2 * a
    for j in (-b+s, -b-s):
        if j % denom != 0:
            continue
        x = j // denom
        if x > 0 and n%x == 0:
            q = x
            break

p = n // q
d = pow(e, -1, (p-1)*(q-1))

print(long_to_bytes(pow(c, d, n)).decode())